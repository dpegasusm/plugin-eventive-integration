(()=>{function e(e){return null==e?"":String(e).toLowerCase()}function t(e){return null==e?"":String(e)}function n(e){return e?String(e).normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,""):""}function i(e){if(!e)return"#000";let t=e.replace("#","");return 3===t.length&&(t=t.split("").map(e=>e+e).join("")),(299*(parseInt(t.substr(0,2),16)||0)+587*(parseInt(t.substr(2,2),16)||0)+114*(parseInt(t.substr(4,2),16)||0))/1e3>128?"#000":"#fff"}function r(e){const t=(e||"").toString().toLowerCase();return"poster"===t||"poster-image"===t||"poster_image"===t?"poster_image":"cover"===t||"cover-image"===t||"cover_image"===t?"cover_image":"still"===t||"still-image"===t||"still_image"===t?"still_image":t}function a(e,t){try{const n=new URL(window.location.href);e?n.searchParams.set("tag-id",e):n.searchParams.delete("tag-id"),"replace"===t?history.replaceState({},"",n.toString()):history.pushState({},"",n.toString())}catch(e){}}function o(e){const t=new Set,n=new Set;return(e||[]).forEach(function(e){if(null==e)return;const i=String(e).trim();i&&(t.add(i),n.add(i.toLowerCase()))}),{ids:t,names:n}}function c(e,t,n,i){const r=e.tags||[];if(!r.length)return!1;const a=i?String(i).trim().toLowerCase():null;for(let e=0;e<r.length;e++){const o=r[e],c=o&&null!=o.id?String(o.id):"",s=o&&null!=o.name?String(o.name).toLowerCase():"";if((!a||c===i||s===a)&&(t.has(c)||n.has(s)))return!0}return!1}function s(s){if(!s||s.__efgInited)return;s.__efgInited=!0,s.id||(s.id="efg-"+Math.random().toString(36).slice(2));const l=window.EventiveBlockData?.eventBucket||"",d=window.EventiveBlockData?.filmSyncEnabled||!1,u=window.EventiveBlockData?.prettyPermalinks||!1,v=window.EventiveBlockData?.filmDetailUrl||"";let f=[];try{f=(s.getAttribute("data-tag-name")||"").split(",").map(e=>e.trim()).filter(Boolean)}catch(e){}let m=[];try{m=(s.getAttribute("data-exclude-tag")||"").split(",").map(e=>e.trim()).filter(Boolean)}catch(e){}const g=s.getAttribute("data-film-id")||"";let p=s.getAttribute("data-image")||"poster";p=r(p);let w=s.getAttribute("data-view")||"grid";const h="true"===s.getAttribute("data-show-events"),y="true"===s.getAttribute("data-show-details"),E="true"===s.getAttribute("data-show-description"),b="true"===s.getAttribute("data-show-tags"),S="true"===s.getAttribute("data-year-round"),L="true"===s.getAttribute("data-search"),_="true"===s.getAttribute("data-show-filter"),A="true"===s.getAttribute("data-show-view-switcher");let C=s.querySelector(".eventive-film-guide-tags-filter");_&&!C&&(C=document.createElement("div"),C.className="eventive-film-guide-tags-filter",s.insertBefore(C,s.firstChild));let k=s.querySelector(".eventive-film-guide-search");if(L&&!k){k=document.createElement("div"),k.className="eventive-film-guide-search";const e=document.createElement("input");e.type="search",e.placeholder="Search films (title, cast, crew)â€¦",e.className="eventive-search-input",k.appendChild(e),C?C.after(k):s.insertBefore(k,s.firstChild)}let q=s.querySelector(".eventive-film-guide-controls");A&&!q&&(q=document.createElement("div"),q.className="eventive-film-guide-controls",q.innerHTML=`\n\t\t\t<label>\n\t\t\t\tView:\n\t\t\t\t<select class="view-selector">\n\t\t\t\t\t<option value="grid" ${"grid"===w?"selected":""}>Grid</option>\n\t\t\t\t\t<option value="list" ${"list"===w?"selected":""}>List</option>\n\t\t\t\t</select>\n\t\t\t</label>\n\t\t\t<label>\n\t\t\t\tImage:\n\t\t\t\t<select class="image-selector">\n\t\t\t\t\t<option value="poster_image" ${"poster_image"===p?"selected":""}>Poster</option>\n\t\t\t\t\t<option value="cover_image" ${"cover_image"===p?"selected":""}>Cover</option>\n\t\t\t\t\t<option value="still_image" ${"still_image"===p?"selected":""}>Still</option>\n\t\t\t\t</select>\n\t\t\t</label>\n\t\t`,k?k.after(q):C?C.after(q):s.insertBefore(q,s.firstChild));let D=s.querySelector(".eventive-film-guide-container");D||(D=document.createElement("div"),D.className="eventive-film-guide-container",s.appendChild(D));const M=D.querySelector(".eventive-film-loading-text");M&&M.remove();let N=D.querySelector(".catalog-film-container.grid"),T=D.querySelector(".catalog-film-container.list");N||(N=document.createElement("div"),N.className="catalog-film-container grid",D.appendChild(N)),T||(T=document.createElement("div"),T.className="catalog-film-container list",D.appendChild(T)),N.style.display="grid"===w?"grid":"none",T.style.display="list"===w?"block":"none";let z=new URLSearchParams(window.location.search).get("tag-id")||"",F="",j=[];const I=o(f),P=o(m);let B=!1;function U(){B||(B=!0,requestAnimationFrame(function(){B=!1,function(){let e=j.slice();if(g&&(e=e.filter(function(e){return String(e.id)===String(g)})),g||!I.ids.size&&!I.names.size||(e=e.filter(function(e){return c(e,I.ids,I.names)})),!g&&z){const t=String(z).trim();e=e.filter(function(e){return c(e,new Set([t]),new Set([t.toLowerCase()]))})}(P.ids.size||P.names.size)&&(e=e.filter(function(e){return!c(e,P.ids,P.names)})),F&&(e=e.filter(function(e){return e._lc_name.indexOf(F)>-1||e._lc_desc.indexOf(F)>-1||e._lc_credits.indexOf(F)>-1})),e.sort(function(e,t){const n=(e.name||"").toLowerCase(),i=(t.name||"").toLowerCase();return n<i?-1:n>i?1:0});const a="list"===w?T||N:N||T;if(!a)return;if(!e.length)return void(a.innerHTML='<p class="no-events">No films found for the selected criteria.</p>');a.innerHTML="";let o=0;requestAnimationFrame(function c(){const s=document.createDocumentFragment(),l=Math.min(o+20,e.length);for(;o<l;o++){const a=e[o],c=y?a.details&&a.details.runtime||"N/A":null,l=y?a.credits&&a.credits.director||"Unknown":null,f=y?a.details&&a.details.year||"N/A":null,m=y?a.details&&a.details.language||"N/A":null,g=r(p),S=(window.EventiveBlockData?.pluginUrl||"")+"assets/images/default-placeholder.svg",L=a[g]||a[p]||S,_=a.short_description||"",A=n(a.name);let C="";C=d?t(v).replace(/\/$/,"")+"/"+A:u?v+"?film-id="+encodeURIComponent(a.id):v+"&film-id="+encodeURIComponent(a.id);let k="";const q=Array.isArray(a.tags)?a.tags:[];if(b&&q&&q.length){const e=new Map;q.forEach(function(t){if(!t)return;const n=null!=t.id?String(t.id):"",i=t.name||t.title||n;i&&e.set(n||i,t)}),k='<div class="eventive-tag-pills">'+Array.from(e.values()).map(function(e){const n=i(e.color||"#e0e0e0");return'<span class="eventive-tag-pill" style="background-color:'+t(e.color||"#e0e0e0")+";color:"+n+'" data-tag-id="'+t(e.id||e.name)+'">'+t(e.name)+"</span>"}).join("")+"</div>"}const D=document.createElement("div");"list"===w?(D.className="eventive-card eventive-card--horizontal",D.innerHTML='<a href="'+C+'"><img class="eventive-card-image" loading="lazy" decoding="async" src="'+L+'" alt="'+(a.name||"Film")+'"/></a><div class="eventive-card-content"><h2 class="eventive-card-title">'+(a.name||"")+"</h2>"+k+'<span class="eventive-card-description">'+(y?"Directed by: "+l+"<br />"+c+" min | "+f+" | "+m:"")+"</span>"+(E&&_?'<div class="eventive-card-description">'+_+"</div>":"")+(h?'<div class="eventive-card-link"><a href="'+C+'">Details & Showtimes</a></div>':"")+"</div>"):(D.className="eventive-card",D.setAttribute("role","article"),D.innerHTML='<a href="'+C+'"><img class="eventive-card-image" loading="lazy" decoding="async" src="'+L+'" alt="'+(a.name||"Film")+'"/></a><div class="eventive-card-content"><h3 class="eventive-card-title">'+(a.name||"")+"</h3>"+k+(y?'<span class="eventive-card-description">'+l+"<br />"+c+" min | "+f+" | "+m+"</span>":"")+(E&&_?'<div class="eventive-card-description">'+_+"</div>":"")+(h?'<div class="eventive-card-link"><a href="'+C+'">Details & Showtimes</a></div>':"")+"</div>"),s.appendChild(D)}a.appendChild(s),o<e.length&&requestAnimationFrame(c)})}()}))}if(q){const e=q.querySelector(".view-selector"),t=q.querySelector(".image-selector");e&&e.addEventListener("change",function(e){w=e.target.value,N.style.display="grid"===w?"grid":"none",T.style.display="list"===w?"block":"none",U()}),t&&t.addEventListener("change",function(e){p=r(e.target.value),U()})}if(k){const e=k.querySelector(".eventive-search-input");if(e){const t=function(e){let t;return function(){const n=arguments,i=this;clearTimeout(t),t=setTimeout(function(){e.apply(i,n)},150)}}(function(){F=(e.value||"").trim().toLowerCase(),U()});e.addEventListener("input",t),e.addEventListener("change",t),e.addEventListener("keydown",function(e){"Enter"===e.key&&(e.preventDefault(),t())})}}function H(){if(C)try{const e=C.querySelectorAll(".eventive-tag-btn");e.forEach(function(e){e.classList.remove("active")}),e.forEach(function(e){const t=e.getAttribute("data-tag-id");z?t===z&&e.classList.add("active"):t||e.classList.add("active")})}catch(e){}}function O(){if(!window.Eventive){const e="list"===w?T:N;return void(e&&(e.innerHTML='<p class="error-message">Eventive API is not available.</p>'))}const n=function(){(function(e,t){const n=e+"::"+(t?"marquee":"all"),i=window.__Eventive_FilmCache;if(i[n])return Promise.resolve(i[n]);if(!window.Eventive)return Promise.reject(new Error("Eventive not ready"));const r={method:"GET",path:"event_buckets/"+encodeURIComponent(e)+"/films",qs:{include:"tags"},authenticatePerson:!1};return t&&(r.qs.marquee=!0),window.Eventive.request(r).then(function(e){const t=e&&e.films||[];return i[n]=t,t})})(l,S).then(function(n){j=function(t){return(t||[]).map(function(t){if(!t)return t;const n=String(t.description||t.short_description||"");let i="";if(t.credits&&"object"==typeof t.credits)try{i=Object.values(t.credits).flat().join(" ")}catch(e){i=Object.values(t.credits).join(" ")}return Object.assign({},t,{_lc_name:e(t.name),_lc_desc:e(n),_lc_credits:e(i)})})}(n),function(e){if(!C)return;let n=e.slice();g||!I.ids.size&&!I.names.size||(n=n.filter(function(e){return c(e,I.ids,I.names)})),(P.ids.size||P.names.size)&&(n=n.filter(function(e){return!c(e,P.ids,P.names)}));const r=function(e){const t=new Map;return(e||[]).forEach(function(e){(Array.isArray(e.tags)?e.tags:[]).forEach(function(e){if(!e)return;const n=null!=e.id?String(e.id):"",i=e.name||e.title||e.label||(n?"#"+n:"");if(!n&&!i)return;const r=t.get(n||i)||{id:n,name:i,color:e.color||"#e0e0e0",count:0};r.count+=1,t.set(n||i,r)})}),Array.from(t.values())}(n);if(!r.length)return void(C.innerHTML="");!function(){try{const e=new URL(window.location.href);return e.searchParams.delete("tag-id"),e.toString()}catch(e){return"#"}}();let a="";a+='<div class="eventive-tags-list">',a+='<button class="eventive-tag-btn" data-tag-id="">All</button>',r.sort(function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:1}),a+=r.map(function(e){const n=i(e.color||"#e0e0e0");return'<button class="eventive-tag-btn" style="background-color:'+t(e.color||"#e0e0e0")+";color:"+n+'" data-tag-id="'+t(e.id||e.name)+'">'+t(e.name)+"</button>"}).join(""),a+="</div>",C.innerHTML=a,H()}(j),U()}).catch(function(){const e="list"===w?T:N;e&&(e.innerHTML='<p class="error-message">Failed to load films.</p>')})};let r=!1;try{window.Eventive&&"function"==typeof window.Eventive.ready&&(window.Eventive.ready(n),r=!0)}catch(e){}if(!r)try{window.Eventive&&window.Eventive.on&&"function"==typeof window.Eventive.on&&(window.Eventive.on("ready",n),r=!0)}catch(e){}if(!r){let e=0;!function t(){window.Eventive&&"function"==typeof window.Eventive.request||++e>60?n():setTimeout(t,50)}()}}document.addEventListener("eventive:setActiveTag",function(e){try{const t=e&&e.detail&&(void 0!==e.detail.tagId?e.detail.tagId:e.detail);if(void 0===t)return;z=String(t||""),a(z,"replace"),H(),U()}catch(e){}}),C&&C.addEventListener("click",function(e){const t=e.target&&e.target.closest?e.target.closest(".eventive-tag-btn"):null;if(!t)return;e.preventDefault(),e.stopPropagation();const n=t.getAttribute("data-tag-id")||"";z=String(n),a(z,"replace"),H(),U()},!0),window.addEventListener("popstate",function(){try{const e=new URL(window.location.href).searchParams.get("tag-id")||"";z=e,H(),U()}catch(e){}}),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",O,{once:!0}):O()}function l(){const e=document.querySelectorAll(".wp-block-eventive-film-guide");e&&e.length&&e.forEach(function(e){if(!e.getAttribute)return;const t=e.parentElement&&e.parentElement.closest&&e.parentElement.closest(".wp-block-eventive-film-guide");t&&t!==e||s(e)})}window.__Eventive_FilmCache=window.__Eventive_FilmCache||{},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",l,{once:!0}):l(),window.jQuery&&window.elementorFrontend&&window.jQuery(window).on("elementor/frontend/init",function(){try{window.elementorFrontend.hooks.addAction("frontend/element_ready/shortcode.default",function(e){if(e&&e[0]){const t=e[0].querySelectorAll(".wp-block-eventive-film-guide");t&&t.length&&t.forEach(s)}})}catch(e){}})})();