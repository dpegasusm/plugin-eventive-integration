(()=>{"use strict";const e=window.wp.element,t=window.ReactJSXRuntime;function n(e){const t=e.replace("#","");return 6===t.length?(299*parseInt(t.substr(0,2),16)+587*parseInt(t.substr(2,2),16)+114*parseInt(t.substr(4,2),16))/1e3>150?"#000000":"#ffffff":"#000000"}function i(e){return e.is_virtual?{name:"Watch Online",color:"#9b59b6"}:e.venue&&e.venue.name?{name:e.venue.name,color:e.venue.color||"#ccc"}:{name:"Unknown Location",color:"#ccc"}}function s(){const[s,a]=(0,e.useState)([]),[r,l]=(0,e.useState)((new Date).getFullYear()),[c,o]=(0,e.useState)((new Date).getMonth()),[d,v]=(0,e.useState)(null),[m,u]=(0,e.useState)(!0),h=window.EventiveBlockData?.eventBucket||"";return(0,e.useEffect)(()=>{if(!h)return void u(!1);const e=()=>{if(!window.Eventive||"function"!=typeof window.Eventive.request)return console.error("[eventive-calendar] Eventive API is not available"),void u(!1);window.Eventive.request({method:"GET",path:`event_buckets/${h}/events`,authenticatePerson:!1}).then(e=>{a(e.events||[]),u(!1)}).catch(e=>{console.error("[eventive-calendar] Error fetching events:",e),u(!1)})};window.Eventive&&window.Eventive._ready?e():window.Eventive&&"function"==typeof window.Eventive.on?window.Eventive.on("ready",e):setTimeout(()=>{window.Eventive&&"function"==typeof window.Eventive.request?e():(console.error("[eventive-calendar] Eventive API not found"),u(!1))},1e3)},[h]),(0,e.useEffect)(()=>{d&&window.Eventive&&window.Eventive.rebuild&&setTimeout(()=>window.Eventive.rebuild(),100)},[d]),m?(0,t.jsx)("div",{className:"eventive-loading",children:"Loading..."}):(0,t.jsxs)("div",{className:"eventive-calendar-container",children:[(()=>{const e=new Date(r,c,1).getDay(),a=new Date(r,c+1,0).getDate(),d=[];for(let n=0;n<e;n++)d.push((0,t.jsx)("td",{className:"empty"},`empty-${n}`));for(let e=1;e<=a;e++){const a=s.filter(t=>{if(t.is_virtual&&!t.start_time&&!t.end_time)return!0;const n=new Date(t.start_time);return n.getDate()===e&&n.getMonth()===c&&n.getFullYear()===r});d.push((0,t.jsx)("td",{className:"eventive-cal-day",children:(0,t.jsxs)("div",{children:[e,a.map(e=>{const s=i(e),a=e.start_time?new Date(e.start_time).toLocaleTimeString([],{hour:"numeric",minute:"2-digit",hour12:!0}).replace(":00",""):e.is_virtual?"All Day":"No Start Time";return(0,t.jsxs)("div",{className:"event-name",style:{backgroundColor:s.color,color:n(s.color)},onClick:()=>v(e),children:[e.name," - ",a]},e.id)})]})},e))}const m=7-(e+a)%7;if(m<7)for(let e=0;e<m;e++)d.push((0,t.jsx)("td",{className:"empty"},`empty-end-${e}`));const u=[];for(let e=0;e<d.length;e+=7)u.push((0,t.jsx)("tr",{children:d.slice(e,e+7)},`week-${e}`));return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"calendar-controls",children:[(0,t.jsx)("button",{onClick:()=>{0===c?(o(11),l(r-1)):o(c-1)},children:"← Prev"}),(0,t.jsxs)("h2",{children:[["January","February","March","April","May","June","July","August","September","October","November","December"][c]," ",r]}),(0,t.jsx)("button",{onClick:()=>{11===c?(o(0),l(r+1)):o(c+1)},children:"Next →"})]}),(0,t.jsxs)("table",{className:"eventive-cal-table",children:[(0,t.jsx)("thead",{children:(0,t.jsx)("tr",{children:["S","M","T","W","T","F","S"].map(e=>(0,t.jsx)("th",{children:e},e))})}),(0,t.jsx)("tbody",{children:u})]})]})})(),d&&(0,t.jsx)("div",{className:"eventive-modal-overlay",children:(0,t.jsxs)("div",{className:"eventive-modal-panel",children:[(0,t.jsx)("button",{className:"eventive-modal-close-btn",onClick:()=>v(null),"aria-label":"Close",children:"×"}),(0,t.jsxs)("div",{className:"event-details",children:[(0,t.jsxs)("div",{className:"details-left",children:[(0,t.jsx)("h2",{children:d.name}),(0,t.jsxs)("p",{children:["Start Time:"," ",d.start_time?new Date(d.start_time).toLocaleTimeString([],{hour:"numeric",minute:"2-digit",hour12:!0}):"All Day"]}),(0,t.jsxs)("p",{children:["Location:"," ",(0,t.jsx)("span",{className:"eventive-venue-tag",style:{background:i(d).color,color:n(i(d).color)},children:i(d).name})]}),d.tags&&d.tags.length>0&&(0,t.jsx)("div",{className:"eventive-tag-pills",children:d.tags.map(e=>(0,t.jsx)("button",{className:"eventive-tag-pill",style:{background:e.color||"#ccc",color:n(e.color||"#ccc")},children:e.name},e.id))})]}),(0,t.jsx)("div",{className:"details-right",children:(0,t.jsx)("div",{className:"eventive-button","data-event":d.id})}),d.films&&d.films.length>0&&(0,t.jsx)("div",{className:"films-container",children:d.films.map(e=>(0,t.jsxs)("div",{className:"film-card",children:[(0,t.jsxs)("div",{className:"film-card-content",children:[(0,t.jsx)("h3",{children:e.name}),(0,t.jsx)("p",{children:e.description})]}),e.poster_image&&(0,t.jsx)("div",{className:"film-poster",children:(0,t.jsx)("img",{src:e.poster_image,alt:e.name})})]},e.id))})]})]})})]})}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".wp-block-eventive-calendar").forEach(n=>{(0,e.createRoot)(n).render((0,t.jsx)(s,{}))})})})();