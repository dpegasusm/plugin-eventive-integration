(()=>{"use strict";const e=window.wp.element,t=window.ReactJSXRuntime;function n(e){const t=e.replace("#","");return 6===t.length?(299*parseInt(t.substr(0,2),16)+587*parseInt(t.substr(2,2),16)+114*parseInt(t.substr(4,2),16))/1e3>150?"#000000":"#ffffff":"#000000"}function s(e){return e.is_virtual?{name:"Watch Online",color:"#9b59b6"}:e.venue&&e.venue.name?{name:e.venue.name,color:e.venue.color||"#ccc"}:{name:"Unknown Location",color:"#ccc"}}function a(){const[a,c]=(0,e.useState)([]),[i,l]=(0,e.useState)((new Date).getFullYear()),[r,o]=(0,e.useState)((new Date).getMonth()),[d,m]=(0,e.useState)(null),[u,v]=(0,e.useState)(!0),h=window.EventiveBlockData?.eventBucket||"";return(0,e.useEffect)(()=>{h?(async()=>{try{const e=window.EventiveBlockData?.apiEndpoints||{},t=window.EventiveBlockData?.eventNonce||"",n=await wp.apiFetch({path:`/eventive/v1/${e.event_buckets}?bucket_id=${h}&endpoint=events&upcoming_only=true&eventive_nonce=${t}`,method:"GET"});c(n.events||[]),v(!1)}catch(e){console.error("Error fetching events:",e),v(!1)}})():v(!1)},[h]),(0,e.useEffect)(()=>{d&&window.Eventive&&window.Eventive.rebuild&&setTimeout(()=>window.Eventive.rebuild(),100)},[d]),u?(0,t.jsx)("div",{className:"eventive-calendar-loading",children:"Loading..."}):(0,t.jsxs)("div",{className:"eventive-calendar-container",children:[(()=>{const e=new Date(i,r,1).getDay(),c=new Date(i,r+1,0).getDate(),d=[];for(let n=0;n<e;n++)d.push((0,t.jsx)("td",{className:"empty"},`empty-${n}`));for(let e=1;e<=c;e++){const c=a.filter(t=>{if(t.is_virtual&&!t.start_time&&!t.end_time)return!0;const n=new Date(t.start_time);return n.getDate()===e&&n.getMonth()===r&&n.getFullYear()===i});d.push((0,t.jsx)("td",{className:"eventive-cal-day",children:(0,t.jsxs)("div",{children:[e,c.map(e=>{const a=s(e),c=e.start_time?new Date(e.start_time).toLocaleTimeString([],{hour:"numeric",minute:"2-digit",hour12:!0}).replace(":00",""):e.is_virtual?"All Day":"No Start Time";return(0,t.jsxs)("div",{className:"event-name",style:{backgroundColor:a.color,color:n(a.color)},onClick:()=>m(e),children:[e.name," - ",c]},e.id)})]})},e))}const u=7-(e+c)%7;if(u<7)for(let e=0;e<u;e++)d.push((0,t.jsx)("td",{className:"empty"},`empty-end-${e}`));const v=[];for(let e=0;e<d.length;e+=7)v.push((0,t.jsx)("tr",{children:d.slice(e,e+7)},`week-${e}`));return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"calendar-controls",children:[(0,t.jsx)("button",{onClick:()=>{0===r?(o(11),l(i-1)):o(r-1)},children:"← Prev"}),(0,t.jsxs)("h2",{children:[["January","February","March","April","May","June","July","August","September","October","November","December"][r]," ",i]}),(0,t.jsx)("button",{onClick:()=>{11===r?(o(0),l(i+1)):o(r+1)},children:"Next →"})]}),(0,t.jsxs)("table",{className:"eventive-cal-table",children:[(0,t.jsx)("thead",{children:(0,t.jsx)("tr",{children:["S","M","T","W","T","F","S"].map(e=>(0,t.jsx)("th",{children:e},e))})}),(0,t.jsx)("tbody",{children:v})]})]})})(),d&&(0,t.jsx)("div",{className:"modal",style:{display:"block"},children:(0,t.jsxs)("div",{className:"modal-content",children:[(0,t.jsx)("span",{className:"close",onClick:()=>m(null),children:"×"}),(0,t.jsxs)("div",{className:"event-details",children:[(0,t.jsxs)("div",{className:"details-left",children:[(0,t.jsx)("h2",{children:d.name}),(0,t.jsxs)("p",{children:["Start Time:"," ",d.start_time?new Date(d.start_time).toLocaleTimeString([],{hour:"numeric",minute:"2-digit",hour12:!0}):"All Day"]}),(0,t.jsxs)("p",{children:["Location:"," ",(0,t.jsx)("span",{className:"venue-tag",style:{background:s(d).color,color:n(s(d).color)},children:s(d).name})]}),d.tags&&d.tags.length>0&&(0,t.jsx)("div",{className:"tags",children:d.tags.map(e=>(0,t.jsx)("button",{className:"tag-button film-tag",style:{background:e.color||"#ccc",color:n(e.color||"#ccc")},children:e.name},e.id))})]}),(0,t.jsx)("div",{className:"details-right",children:(0,t.jsx)("div",{className:"eventive-button","data-event":d.id})}),d.films&&d.films.length>0&&(0,t.jsx)("div",{className:"films-container",children:d.films.map(e=>(0,t.jsxs)("div",{className:"film-card",children:[(0,t.jsxs)("div",{className:"film-card-content",children:[(0,t.jsx)("h3",{children:e.name}),(0,t.jsx)("p",{children:e.description})]}),e.poster_image&&(0,t.jsx)("div",{className:"film-poster",children:(0,t.jsx)("img",{src:e.poster_image,alt:e.name})})]},e.id))})]})]})})]})}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".wp-block-eventive-eventive-calendar").forEach(n=>{(0,e.createRoot)(n).render((0,t.jsx)(a,{}))})})})();