(()=>{"use strict";const e=window.wp.element,t=window.ReactJSXRuntime;function i(){const[i,n]=(0,e.useState)(!1),[c,s]=(0,e.useState)(!0),[a,o]=(0,e.useState)([]),[l,d]=(0,e.useState)(!1),[r,v]=(0,e.useState)(null);(0,e.useEffect)(()=>{const e=async()=>{if(window.Eventive&&window.Eventive.isLoggedIn)try{const e=window.Eventive.isLoggedIn();n(e),e&&await m()}catch(e){console.error("Error checking login:",e)}finally{s(!1)}else setTimeout(e,100)};window.Eventive&&window.Eventive.on&&window.Eventive.on("ready",e),e()},[]);const m=async()=>{try{const e=await window.Eventive.request({method:"GET",path:"tickets?self=true",authenticatePerson:!0}),t=e&&(e.tickets||e)||[];o(t)}catch(e){console.error("[eventive-account-tickets] Error fetching tickets:",e)}},h=()=>{d(!1),v(null)};return c?(0,t.jsx)("div",{className:"eventive-login-container",style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100px"},children:(0,t.jsx)("div",{className:"loader"})}):i?(0,t.jsxs)("div",{className:"eventive-account-tickets",children:[(0,t.jsxs)("div",{className:"eventive-tickets-column",children:[(0,t.jsx)("h2",{children:"Tickets"}),0===a.length?(0,t.jsx)("p",{children:"No tickets found."}):(0,t.jsx)("div",{className:"eventive-tickets-list",children:a.map((e,i)=>{const n=e.film_name||e.event_name||"Event",c=e.showtime||e.start_time;return(0,t.jsxs)("div",{className:"eventive-ticket-card",children:[(0,t.jsxs)("div",{className:"eventive-ticket-card__body",children:[(0,t.jsx)("div",{className:"eventive-ticket-card__title",children:n}),c&&(0,t.jsx)("div",{className:"eventive-ticket-card__time",children:new Date(c).toLocaleString()})]}),(0,t.jsx)("div",{className:"eventive-ticket-card__actions",children:(0,t.jsx)("button",{className:"eventive-ticket-btn",onClick:()=>(e=>{v(e),d(!0)})(e),children:"View Ticket"})})]},i)})})]}),l&&r&&(0,t.jsx)("div",{className:"eventive-ticket-barcode-modal",onClick:e=>e.target.classList.contains("eventive-ticket-barcode-modal")&&h(),children:(0,t.jsxs)("div",{className:"barcode-modal-inner",children:[(0,t.jsx)("button",{className:"modal-close-btn",onClick:h,children:"Ã—"}),(0,t.jsxs)("div",{className:"barcode-modal-body",children:[(0,t.jsx)("h3",{children:r.film_name||r.event_name}),r.barcode_url&&(0,t.jsx)("img",{src:r.barcode_url,alt:"Ticket Barcode",className:"barcode-img"}),r.showtime&&(0,t.jsx)("p",{className:"ticket-time",children:new Date(r.showtime).toLocaleString()})]})]})})]}):(0,t.jsx)("div",{className:"eventive-notice",style:{textAlign:"center"},children:"Please log in to view your tickets."})}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".wp-block-eventive-account-tickets").forEach(n=>{(0,e.createRoot)(n).render((0,t.jsx)(i,{}))})})})();