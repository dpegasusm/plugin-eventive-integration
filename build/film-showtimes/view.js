(()=>{"use strict";var e={n:t=>{var i=t&&t.__esModule?()=>t.default:()=>t;return e.d(i,{a:i}),i},d:(t,i)=>{for(var n in i)e.o(i,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:i[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.element,i=window.wp.apiFetch;var n=e.n(i);const s=window.ReactJSXRuntime;function o({filmId:e,bucketId:i}){const[n,o]=(0,t.useState)([]),[v,r]=(0,t.useState)(!0),[c,d]=(0,t.useState)(null);return(0,t.useEffect)(()=>e&&i?window.Eventive&&window.Eventive.request?void window.Eventive.request({method:"GET",path:`event_buckets/${i}/films/${e}/events`,authenticatePerson:!1}).then(e=>{const t=e.events||[];if(0===t.length)d("No upcoming showtimes available");else{const e=function(e){const t={};return e.forEach(e=>{const i=new Date(e.start_time).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});t[i]||(t[i]=[]),t[i].push(e)}),Object.keys(t).forEach(e=>{t[e].sort((e,t)=>new Date(e.start_time)-new Date(t.start_time))}),t}(t);o(e)}r(!1)}).catch(e=>{console.error("[eventive-film-showtimes] Error fetching showtimes:",e),d("Unable to load showtimes"),r(!1)}):(d("Eventive API not available"),void r(!1)):(d("Missing film or bucket ID"),void r(!1)),[e,i]),(0,t.useEffect)(()=>{!v&&!c&&n.length>0&&window.Eventive?.rebuild&&window.Eventive.rebuild()},[v,c,n]),v?(0,s.jsx)("div",{className:"eventive-loading",children:"Loading showtimes..."}):c?(0,s.jsx)("div",{className:"eventive-error",children:c}):(0,s.jsx)("div",{className:"eventive-film-showtimes-container",children:Object.entries(n).map(([e,t])=>(0,s.jsxs)("div",{className:"eventive-showtime-date-group",children:[(0,s.jsx)("h3",{className:"eventive-showtime-date",children:e}),(0,s.jsx)("div",{className:"eventive-showtime-list",children:t.map(e=>(0,s.jsx)(a,{event:e},e.id))})]},e))})}function a({event:e}){const t=new Date(e.start_time).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),i=e.venue?.name||"Venue TBA";return(0,s.jsxs)("div",{className:"eventive-showtime-item",children:[(0,s.jsxs)("div",{className:"eventive-showtime-info",children:[(0,s.jsx)("span",{className:"eventive-showtime-time",children:t}),(0,s.jsx)("span",{className:"eventive-showtime-venue",children:i})]}),(0,s.jsx)("div",{className:"eventive-showtime-button",children:(0,s.jsx)("div",{className:"eventive-button","data-event":e.id})})]})}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".wp-block-eventive-film-showtimes").forEach(e=>{const i=window.EventiveBlockData?.postId;i?(e.innerHTML='<div class="eventive-loading">Loading showtimes...</div>',n()({path:`/wp/v2/eventive_film/${i}`}).then(i=>{const n=i.meta?._eventive_film_id,a=i.meta?._eventive_bucket_id||window.EventiveBlockData?.eventBucket||"";n&&a?(0,t.createRoot)(e).render((0,s.jsx)(o,{filmId:n,bucketId:a})):e.innerHTML='<div class="eventive-error">Missing film or bucket configuration.</div>'}).catch(t=>{console.error("[eventive-film-showtimes] Error fetching post data:",t),e.innerHTML='<div class="eventive-error">Unable to load film data. Please try again later.</div>'})):e.innerHTML='<div class="eventive-error">This block requires it be placed on a Eventive Film post type.</div>'})})})();