(()=>{"use strict";function e(e,t){try{return t.reduce((e,t)=>e&&void 0!==e[t]?e[t]:void 0,e)}catch(e){return}}function t(e){if(!Array.isArray(e))return"";for(let t=0;t<e.length;t++){const r=e[t];if(r){if("string"==typeof r&&r.trim())return r.trim();if("object"==typeof r&&"string"==typeof r.url&&r.url.trim())return r.url.trim()}}return""}function r(e,t){if(!t||!t.length)return!1;const r=function(e){const t=[];return Array.isArray(e.tags)&&e.tags.forEach(e=>{const r=e&&(e.name||e.title||e.label)?String(e.name||e.title||e.label).toLowerCase():"";r&&t.push(r)}),Array.isArray(e.tag_names)&&e.tag_names.forEach(e=>{const r=e?String(e).toLowerCase():"";r&&t.push(r)}),Array.isArray(e.categories)&&e.categories.forEach(e=>{const r=e?String(e).toLowerCase():"";r&&t.push(r)}),e.category&&t.push(String(e.category).toLowerCase()),Array.from(new Set(t))}(e);return t.some(e=>r.indexOf(e)>-1)}function n(e){return e?String(e).split(",").map(e=>e.trim().toLowerCase().replace(/\s+/g," ")).filter(Boolean):[]}window.wp.element,document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".eventive-marquee-wrapper").forEach(a=>{if(a.__inited)return;a.__inited=!0;const i=window.EventiveBlockData?.apiEndpoints||{},o=window.EventiveBlockData?.eventNonce||"",s=window.EventiveBlockData?.eventBucket||window.eventiveOptions?.eventBucket||"",l=a.querySelector(".eventive-marquee-overlay"),c=a.getAttribute("data-overlay-url")||"",u=parseFloat(a.getAttribute("data-overlay-opacity")||"0.22");l&&(l.style.backgroundImage=c?`url(${c})`:"",l.style.opacity=isNaN(u)?"0.22":String(Math.max(0,Math.min(1,u))));const d=(a.getAttribute("data-caption")||"").trim(),m=a.querySelector(".eventive-marquee-caption-track");if(m)if(d){const e=" â€¢ "+d+" ";let t=d;for(;t.length<200;)t+=e;m.textContent=t}else m.textContent="";const g="true"===a.getAttribute("data-film-sync-enabled"),p="true"===a.getAttribute("data-pretty-permalinks"),f=a.getAttribute("data-detail-base-url")||"",h=a.querySelector(".eventive-marquee");if(!h)return;const y=h.getAttribute("data-tag")||"",v=Math.min(parseInt(h.getAttribute("data-number"),10)||5,50),w=(h.getAttribute("data-stills")||"").toString().toLowerCase(),A="true"===w||"1"===w||"yes"===w,b="true"===h.getAttribute("data-year-round"),C=h.getAttribute("data-exclude")||"";(async()=>{try{const c=new URLSearchParams;b&&c.append("marquee","true"),c.append("eventive_nonce",o);const u=await wp.apiFetch({path:`/eventive/v1/${i.event_buckets}/${s}/films?${c.toString()}`,method:"GET"}),d=function(e,t,a){const i=n(t),o=n(a);return(e||[]).filter(e=>{const t=!i.length||r(e,i),n=!o.length||!r(e,o);return t&&n})}(u&&u.films||[],y,C),w=document.createElement("div");w.className="marquee-content";const E=210;d.slice(0,v).forEach(r=>{const n=function(r,n){const a=[e(r,["images","still_image"]),e(r,["images","still"]),e(r,["images","stillImage"]),e(r,["images","still_url"]),e(r,["images","still","url"]),e(r,["images","still_image","url"]),e(r,["still_image"]),e(r,["still_url"])],i=[e(r,["poster_image"]),e(r,["images","poster_image"]),e(r,["images","poster"]),e(r,["images","poster","url"]),e(r,["poster","url"])];let o="";return n&&(o=t(a)),o||(o=t(i)),o||""}(r,A);w.appendChild(((e,t,r)=>{if(!t){const e=document.createElement("a");return e.href="#",e.className="poster-slide placeholder",e.setAttribute("aria-hidden","true"),e}const n=String(e||"").toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").trim();let a;a=g?f.replace(/\/$/,"")+"/"+n:p?f+"?film-id="+encodeURIComponent(r):f+"&film-id="+encodeURIComponent(r);const i=document.createElement("div");i.className="poster-slide",i.style.backgroundImage="url('"+t+"')";const o=document.createElement("a");return o.href=a,o.target="_self",o.appendChild(i),o.addEventListener("click",e=>{e.stopPropagation()}),o})(r.name,n,r.id))});let _=Array.from(w.children),S=_.length*E;const L=h.offsetWidth;for(;S<L;)_.forEach(e=>{w.appendChild(e.cloneNode(!0))}),_=Array.from(w.children),S=_.length*E;l=w,Array.from(l.children).forEach(e=>{l.appendChild(e.cloneNode(!0))});const k=w.children.length*E;w.style.width=k+"px";const q=60,N=20,x=180,I=Math.max(N,Math.min(x,Math.round(k/q)));w.style.animationDuration=I+"s";const M=(a.getAttribute("data-caption-speed")||"match").toLowerCase();let B=I;const D=parseInt(M,10);!isNaN(D)&&D>0&&(B=D),m&&(m.textContent||"").trim().length&&(m.style.animationDuration=B+"s",m.classList.add("caption-scroll")),h.appendChild(w)}catch(e){console.error("Error fetching marquee films:",e)}var l})()})})})();