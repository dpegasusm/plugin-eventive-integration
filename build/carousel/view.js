(()=>{"use strict";const e=window.wp.element,t=window.ReactJSXRuntime;function n({event:e,isActive:n}){const i=e.name||"Untitled Event",s=e.start_time?new Date(e.start_time):null,a=s?s.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}).toLowerCase():"Time not available",o=s?s.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"}):"Date not available",r=e.venue&&e.venue.name?` at ${e.venue.name}`:"",l=function(e){return e.images&&(e.images.cover_image||e.images.cover)||e.cover_image||e.films&&e.films[0]&&(e.films[0].still_image||e.films[0].cover_image||e.films[0].poster_image)||""}(e),c=!e.hide_tickets_button;return(0,t.jsx)("div",{className:"carousel-slide "+(n?"active":""),style:{backgroundImage:`url('${l}')`},children:(0,t.jsxs)("div",{className:"carousel-banner",children:[(0,t.jsx)("h3",{className:"carousel-title",children:i}),(0,t.jsxs)("p",{className:"carousel-time",children:[o," • ",a,r]}),c&&(0,t.jsx)("div",{className:"carousel-ticket-button",children:(0,t.jsx)("div",{className:"eventive-button","data-event":e.id})})]})})}function i({limit:i,showDescription:s}){const[a,o]=(0,e.useState)([]),[r,l]=(0,e.useState)(0),[c,u]=(0,e.useState)(!0),[v,d]=(0,e.useState)(!1),m=(0,e.useRef)(null),w=(0,e.useRef)(null),h=window.EventiveBlockData?.eventBucket||"";return(0,e.useEffect)(()=>{if(!h)return void u(!1);const e=()=>{window.Eventive.request({method:"GET",path:`event_buckets/${h}/events`,authenticatePerson:!1}).then(e=>{const t=e.events||[];o(t.slice(0,i)),u(!1)}).catch(e=>{console.error("[eventive-carousel] Error fetching events:",e),u(!1)})};window.Eventive&&window.Eventive._ready?e():window.Eventive&&"function"==typeof window.Eventive.on?window.Eventive.on("ready",e):setTimeout(()=>{window.Eventive&&"function"==typeof window.Eventive.request?e():(console.error("[eventive-carousel] Eventive API not available"),u(!1))},1e3)},[h,i]),(0,e.useEffect)(()=>{if(!(a.length<=1||v))return window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches?void 0:(w.current=setInterval(()=>{l(e=>(e+1)%a.length)},5e3),()=>{w.current&&clearInterval(w.current)})},[a.length,v]),(0,e.useEffect)(()=>{a.length>0&&m.current&&setTimeout(()=>{window.Eventive&&window.Eventive.rebuild&&window.Eventive.rebuild(m.current)},100)},[r,a]),c?(0,t.jsx)("div",{className:"carousel-loading",children:"Loading events..."}):0===a.length?(0,t.jsx)("div",{className:"carousel-error",children:"No upcoming events found."}):(0,t.jsx)("div",{ref:m,className:"event-carousel-container",onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),children:(0,t.jsxs)("div",{className:"carousel-slider",children:[(0,t.jsx)("button",{className:"carousel-arrow left",onClick:()=>{l(e=>(e-1+a.length)%a.length)},"aria-label":"Previous",children:"‹"}),(0,t.jsx)("button",{className:"carousel-arrow right",onClick:()=>{l(e=>(e+1)%a.length)},"aria-label":"Next",children:"›"}),(0,t.jsx)("div",{className:"carousel-slides",children:a.map((e,i)=>(0,t.jsx)(n,{event:e,isActive:i===r},e.id))}),(0,t.jsx)("div",{className:"carousel-dots",children:a.map((e,n)=>(0,t.jsx)("button",{className:"carousel-dot "+(n===r?"active":""),onClick:()=>(e=>{l(e)})(n),"aria-label":`Go to slide ${n+1}`},n))})]})})}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".wp-block-eventive-eventive-carousel").forEach(n=>{const s=parseInt(n.dataset.limit||"10",10),a="true"===n.dataset.showDescription;(0,e.createRoot)(n).render((0,t.jsx)(i,{limit:s,showDescription:a}))})})})();