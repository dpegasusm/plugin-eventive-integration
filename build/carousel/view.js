(()=>{"use strict";const e=window.wp.element,t=window.ReactJSXRuntime;function n({event:e,isActive:n}){const i=e.name||"Untitled Event",a=e.start_time?new Date(e.start_time):null,s=a?a.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}).toLowerCase():"Time not available",c=a?a.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"}):"Date not available",o=e.venue&&e.venue.name?` at ${e.venue.name}`:"",l=function(e){return e.images&&(e.images.cover_image||e.images.cover)||e.cover_image||e.films&&e.films[0]&&(e.films[0].still_image||e.films[0].cover_image||e.films[0].poster_image)||""}(e),r=!e.hide_tickets_button;return(0,t.jsx)("div",{className:"carousel-slide "+(n?"active":""),style:{backgroundImage:`url('${l}')`},children:(0,t.jsxs)("div",{className:"carousel-banner",children:[(0,t.jsx)("h3",{className:"carousel-title",children:i}),(0,t.jsxs)("p",{className:"carousel-time",children:[c," • ",s,o]}),r&&(0,t.jsx)("div",{className:"carousel-ticket-button",children:(0,t.jsx)("div",{className:"eventive-button","data-event":e.id})})]})})}function i({limit:i,showDescription:a}){const[s,c]=(0,e.useState)([]),[o,l]=(0,e.useState)(0),[r,u]=(0,e.useState)(!0),[d,v]=(0,e.useState)(!1),m=(0,e.useRef)(null),h=(0,e.useRef)(null),w=window.EventiveBlockData?.eventBucket||"";return(0,e.useEffect)(()=>{w?(async()=>{try{const e=window.EventiveBlockData?.apiEndpoints||{},t=window.EventiveBlockData?.eventNonce||"",n=(await wp.apiFetch({path:`/eventive/v1/${e.event_buckets}?bucket_id=${w}&endpoint=events&upcoming_only=true&eventive_nonce=${t}`,method:"GET"})).events||[];c(n.slice(0,i)),u(!1)}catch(e){console.error("Error fetching events:",e),u(!1)}})():u(!1)},[w,i]),(0,e.useEffect)(()=>{if(!(s.length<=1||d))return window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches?void 0:(h.current=setInterval(()=>{l(e=>(e+1)%s.length)},5e3),()=>{h.current&&clearInterval(h.current)})},[s.length,d]),(0,e.useEffect)(()=>{s.length>0&&m.current&&setTimeout(()=>{window.Eventive&&window.Eventive.rebuild&&window.Eventive.rebuild(m.current)},100)},[o,s]),r?(0,t.jsx)("div",{className:"carousel-loading",children:"Loading events..."}):0===s.length?(0,t.jsx)("div",{className:"carousel-error",children:"No upcoming events found."}):(0,t.jsx)("div",{ref:m,className:"event-carousel-container",onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),children:(0,t.jsxs)("div",{className:"carousel-slider",children:[(0,t.jsx)("button",{className:"carousel-arrow left",onClick:()=>{l(e=>(e-1+s.length)%s.length)},"aria-label":"Previous",children:"‹"}),(0,t.jsx)("button",{className:"carousel-arrow right",onClick:()=>{l(e=>(e+1)%s.length)},"aria-label":"Next",children:"›"}),(0,t.jsx)("div",{className:"carousel-slides",children:s.map((e,i)=>(0,t.jsx)(n,{event:e,isActive:i===o},e.id))}),(0,t.jsx)("div",{className:"carousel-dots",children:s.map((e,n)=>(0,t.jsx)("button",{className:"carousel-dot "+(n===o?"active":""),onClick:()=>(e=>{l(e)})(n),"aria-label":`Go to slide ${n+1}`},n))})]})})}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".wp-block-eventive-eventive-carousel").forEach(n=>{const a=parseInt(n.dataset.limit||"10",10),s="true"===n.dataset.showDescription;(0,e.createRoot)(n).render((0,t.jsx)(i,{limit:a,showDescription:s}))})})})();