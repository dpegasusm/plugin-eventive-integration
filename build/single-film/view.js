(()=>{"use strict";window.wp.element,document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".wp-block-eventive-single-film").forEach(t=>{const e=t.dataset.filmId,n=t.dataset.eventId;if(!e&&!n){const e=t.querySelector("#single-film-or-event-container");return void(e&&(e.innerHTML="<div>Please provide either a valid film ID or event ID.</div>"))}const i=window.eventiveSettings?.eventBucket||"",a=window.EventiveBlockData?.apiEndpoints||{},s=window.EventiveBlockData?.eventNonce||"",o=t.querySelector("#hero-section"),v=t.querySelector("#details-container");(async()=>{if(e)try{const t=await wp.apiFetch({path:`/eventive/v1/${a.films}/${e}?eventive_nonce=${s}`,method:"GET"});o&&(o.style.backgroundImage=`url('${t.cover_image||""}')`,o.innerHTML=`\n\t\t\t\t\t\t\t\t<div class="hero-overlay">\n\t\t\t\t\t\t\t\t\t<h1 class="film-title">${t.name}</h1>\n\t\t\t\t\t\t\t\t</div>`);const n=(t.tags||[]).map(t=>`<span class="film-tag">${t.name}</span>`).join("");if(v){v.innerHTML=`\n\t\t\t\t\t\t\t\t<div class="film-details">\n\t\t\t\t\t\t\t\t\t<h2>About the Film</h2>\n\t\t\t\t\t\t\t\t\t<p>${t.description||"No description available."}</p>\n\t\t\t\t\t\t\t\t\t<div class="film-info">\n\t\t\t\t\t\t\t\t\t\t<div><strong>Director:</strong> ${t.credits?.director||"Unknown"}</div>\n\t\t\t\t\t\t\t\t\t\t<div><strong>Runtime:</strong> ${t.details?.runtime||"N/A"} minutes</div>\n\t\t\t\t\t\t\t\t\t\t<div><strong>Year:</strong> ${t.details?.year||"N/A"}</div>\n\t\t\t\t\t\t\t\t\t\t<div><strong>Language:</strong> ${t.details?.language||"N/A"}</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="film-tags">${n}</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div id="film-events-container">\n\t\t\t\t\t\t\t\t\t<h2>Upcoming Screenings</h2>\n\t\t\t\t\t\t\t\t</div>`;const o=await wp.apiFetch({path:`/eventive/v1/${a.event_buckets}/${i}/films/${e}/events?eventive_nonce=${s}`,method:"GET"}),r=document.getElementById("film-events-container"),d=o.events||[];0===d.length?r.innerHTML+="<p>No upcoming screenings found for this film.</p>":r.innerHTML+=d.map(t=>`\n\t\t\t\t\t\t\t\t\t\t<div class="event-item">\n\t\t\t\t\t\t\t\t\t\t\t<h3>${t.name}</h3>\n\t\t\t\t\t\t\t\t\t\t\t<p>${new Date(t.start_time).toLocaleString()}</p>\n\t\t\t\t\t\t\t\t\t\t\t<div class="eventive-button" data-event="${t.id}"></div>\n\t\t\t\t\t\t\t\t\t\t</div>`).join(""),window.Eventive?.rebuild&&window.Eventive.rebuild()}}catch(t){console.error("Error fetching film data:",t),v&&(v.innerHTML="<p>Error loading film details.</p>")}else if(n)try{const t=await wp.apiFetch({path:`/eventive/v1/${a.events}/${n}?eventive_nonce=${s}`,method:"GET"});o&&(o.style.backgroundImage=`url('${t.films?.[0]?.cover_image||""}')`,o.innerHTML=`\n\t\t\t\t\t\t\t\t<div class="hero-overlay">\n\t\t\t\t\t\t\t\t\t<h1 class="event-title">${t.name}</h1>\n\t\t\t\t\t\t\t\t\t<div class="eventive-button" data-event="${t.id}"></div>\n\t\t\t\t\t\t\t\t</div>`);const e=(t.films||[]).map(t=>`\n\t\t\t\t\t\t\t<div class="film-card">\n\t\t\t\t\t\t\t\t<img src="${t.poster_image}" alt="${t.name}" class="film-poster">\n\t\t\t\t\t\t\t\t<h3>${t.name}</h3>\n\t\t\t\t\t\t\t\t<p>${t.description||"No description available."}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t`).join("");v&&(v.innerHTML=`\n\t\t\t\t\t\t\t\t<div class="event-details">\n\t\t\t\t\t\t\t\t\t<h2>About the Event</h2>\n\t\t\t\t\t\t\t\t\t<p>${t.description||"No description available."}</p>\n\t\t\t\t\t\t\t\t\t<div class="event-info">\n\t\t\t\t\t\t\t\t\t\t<div><strong>Venue:</strong> ${t.venue?.name||"N/A"}</div>\n\t\t\t\t\t\t\t\t\t\t<div><strong>Date & Time:</strong> ${new Date(t.start_time).toLocaleString()}</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="event-films">\n\t\t\t\t\t\t\t\t\t<h2>Featured Films</h2>\n\t\t\t\t\t\t\t\t\t<div class="films-container">\n\t\t\t\t\t\t\t\t\t\t${e}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>`),window.Eventive?.rebuild&&window.Eventive.rebuild()}catch(t){console.error("Error fetching event data:",t),v&&(v.innerHTML="<p>Error loading event details.</p>")}})()})})})();